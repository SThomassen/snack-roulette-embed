<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snack Roulette Embed</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: transparent;
            overflow: hidden;
        }
        
        .embed-container {
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .compact-roulette {
            display: inline-block;
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            font-family: 'Arial', sans-serif;
        }
        
        .title {
            font-size: 2rem;
            font-weight: 600;
            color: #ff6b6b;
            margin-bottom: 20px;
            font-family: 'Arial', sans-serif;
        }
        
        .roulette-container {
            position: relative;
            display: inline-block;
            margin: 0 auto 15px;
        }
        
        .roulette-wheel {
            border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 3px solid #fff;
        }
        
        .roulette-pointer {
            position: absolute;
            top: 50%;
            right: -8px;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 12px solid transparent;
            border-bottom: 12px solid transparent;
            border-right: 24px solid #ff6b6b;
            z-index: 10;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }
        
        .controls-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .spin-button {
            background: #4ecdc4;
            color: white;
            border: none;
            padding: 10px 20px;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
            min-width: 80px;
        }
        
        .hamburger-button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 15px;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
            min-width: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .spin-button:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
        }
        
        .hamburger-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
            background: #ff5252;
        }
        
        .spin-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .spin-button.spinning {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .result {
            margin: 10px 0;
            padding: 10px;
            background: linear-gradient(45deg, #96ceb4, #feca57);
            border-radius: 8px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            animation: bounceIn 0.6s linear;
            font-weight: 600;
            color: #333;
        }
        
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.05); }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); opacity: 1; }
        }
        
        /* Menu Overlay */
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .menu-content {
            background: white;
            border-radius: 15px;
            padding: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .menu-header h3 {
            margin: 0;
            color: #333;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .close-button {
            background: #ff6b6b;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .close-button:hover {
            background: #ff5252;
            transform: scale(1.1);
        }
        
        .snacks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            margin-top: 10px;
        }
        
        .snack-item {
            display: flex;
            align-items: center;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            font-size: 12px;
        }
        
        .snack-item:hover {
            background: #e9ecef;
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        
        .snack-item.disabled {
            opacity: 0.5;
            background: #f1f3f4;
        }
        
        .snack-item input[type="checkbox"] {
            margin-right: 6px;
            width: 14px;
            height: 14px;
            accent-color: #4ecdc4;
            cursor: pointer;
        }
        
        .snack-name {
            font-weight: 500;
            color: #333;
            font-size: 11px;
        }
        
        .snack-item.disabled .snack-name {
            color: #999;
            text-decoration: line-through;
        }
        
        /* Responsive adjustments */
        @media (max-width: 480px) {
            .compact-roulette {
                padding: 15px;
            }
            
            .snacks-grid {
                grid-template-columns: 1fr;
            }
            
            .menu-overlay {
                padding: 10px;
            }
            
            .menu-content {
                padding: 15px;
                max-height: 90vh;
            }
            
            .menu-header h3 {
                font-size: 1.1rem;
            }
            
            .controls-row {
                flex-direction: column;
                gap: 8px;
            }
            
            .hamburger-button {
                min-width: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="embed-container">
        <div class="compact-roulette" id="roulette-container">
            <h1 id="title" class="title" style="display: none;"></h1>
            
            <div class="roulette-container">
                <canvas id="roulette-canvas" class="roulette-wheel"></canvas>
                <div class="roulette-pointer"></div>
            </div>
            
            <div id="controls-row" class="controls-row">
                <button id="spin-button" class="spin-button">
                    Spin!
                </button>
                
                <button id="hamburger-button" class="hamburger-button" title="Select snacks">
                    ☰
                </button>
            </div>
            
            <div id="result" class="result" style="display: none;">
                🎉 <span id="result-text"></span>!
            </div>
        </div>
        
        <!-- Hamburger Menu Overlay -->
        <div id="menu-overlay" class="menu-overlay" style="display: none;">
            <div class="menu-content">
                <div class="menu-header">
                    <h3>Select Snacks</h3>
                    <button id="close-button" class="close-button" title="Close menu">
                        ✕
                    </button>
                </div>
                <div id="snacks-grid" class="snacks-grid">
                    <!-- Snacks will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const CONFIG = {
            size: 300,
            showControls: 'compact', // 'hidden' | 'compact' | 'full'
            title: '🍿 Snack Roulette 🍿',
            snacks: [
                'Kroket', 'Goulashkroket', 'Kalfskroket', 'Kwekkeboomkroket', 'Satekroket',
                'Frikandel', 'Frikandel speciaal', 'Frikandel XXL', 'Frikandel XXL speciaal',
                'Viandel', 'Spicy viandel', 'Kipcorn', 'Mexicano', 'Sitostick', 'Gehaktbal',
                'Berenklauw', 'Crizly', 'Nasischijf', 'Bamiblok', 'Kaassoufle',
                'Ham-kaassoufle', 'Saterol', 'Shoarmarol', 'Smulrol', 'Shalik',
                'Kipburger', 'Loempia', 'Halve haan', 'Sate kip', 'Bitterballen (6st.)',
                'Kipfingers (6st.)', 'Kipnuggets (6st.)', 'Vlammetjes (6st.)',
                'Pikanto', 'Hete donder', 'Ribster', 'Aprio stick'
            ],
            colors: [
                '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3',
                '#a8e6cf', '#ffd3a5', '#fd79a8', '#6c5ce7', '#74b9ff', '#00b894'
            ]
        };

        // State
        let isSpinning = false;
        let selectedSnack = null;
        let rotation = 0;
        let enabledSnacks = CONFIG.snacks.map((_, index) => index);
        let showMenu = false;
        let animationId = null;

        // DOM elements
        const canvas = document.getElementById('roulette-canvas');
        const ctx = canvas.getContext('2d');
        const spinButton = document.getElementById('spin-button');
        const hamburgerButton = document.getElementById('hamburger-button');
        const resultDiv = document.getElementById('result');
        const resultText = document.getElementById('result-text');
        const menuOverlay = document.getElementById('menu-overlay');
        const closeButton = document.getElementById('close-button');
        const snacksGrid = document.getElementById('snacks-grid');

        // Initialize
        function init() {
            // Set canvas size
            canvas.width = CONFIG.size;
            canvas.height = CONFIG.size;
            
            // Set container size
            const container = document.getElementById('roulette-container');
            container.style.width = CONFIG.size + 40 + 'px';
            container.style.height = CONFIG.size + 100 + 'px';
            
            // Handle title display
            const titleElement = document.getElementById('title');
            if (CONFIG.title && CONFIG.title.trim() !== '') {
                titleElement.textContent = CONFIG.title;
                titleElement.style.display = 'block';
            } else {
                titleElement.style.display = 'none';
            }
            
            // Handle controls display
            const controlsRow = document.getElementById('controls-row');
            if (CONFIG.showControls === 'hidden') {
                controlsRow.style.display = 'none';
            } else if (CONFIG.showControls === 'compact') {
                controlsRow.style.display = 'flex';
                hamburgerButton.style.display = 'block';
            } else if (CONFIG.showControls === 'full') {
                controlsRow.style.display = 'flex';
                hamburgerButton.style.display = 'none';
                // For full mode, we'd need to add full snack selector below
                // This is a simplified version for now
            }
            
            // Setup event listeners
            spinButton.addEventListener('click', startRoulette);
            hamburgerButton.addEventListener('click', () => setShowMenu(true));
            closeButton.addEventListener('click', () => setShowMenu(false));
            menuOverlay.addEventListener('click', (e) => {
                if (e.target === menuOverlay) setShowMenu(false);
            });
            
            // Populate snacks grid
            populateSnacksGrid();
            
            // Draw initial wheel
            drawWheel();
        }

        function populateSnacksGrid() {
            snacksGrid.innerHTML = '';
            CONFIG.snacks.forEach((snack, index) => {
                const label = document.createElement('label');
                label.className = `snack-item ${!enabledSnacks.includes(index) ? 'disabled' : ''}`;
                
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.checked = enabledSnacks.includes(index);
                checkbox.addEventListener('change', () => toggleSnack(index));
                
                const span = document.createElement('span');
                span.className = 'snack-name';
                span.textContent = snack;
                
                label.appendChild(checkbox);
                label.appendChild(span);
                snacksGrid.appendChild(label);
            });
        }

        function toggleSnack(index) {
            if (enabledSnacks.includes(index)) {
                enabledSnacks = enabledSnacks.filter(i => i !== index);
            } else {
                enabledSnacks = [...enabledSnacks, index].sort((a, b) => a - b);
            }
            
            // Update UI
            populateSnacksGrid();
            drawWheel();
        }

        function startRoulette() {
            if (enabledSnacks.length === 0) {
                return;
            }

            isSpinning = true;
            selectedSnack = null;
            resultDiv.style.display = 'none';
            spinButton.textContent = 'Spinning...';
            spinButton.disabled = true;
            
            // Random rotation between 5-10 full rotations plus random angle
            const randomRotations = 5 + Math.random() * 5;
            const randomAngle = Math.random() * 360;
            const targetRotation = rotation + (randomRotations * 360) + randomAngle;
            
            // Animate to target
            animateToTarget(targetRotation);
        }

        function animateToTarget(targetRotation) {
            const startRotation = rotation;
            const startTime = Date.now();
            const duration = 3000; // 3 seconds
            
            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // Easing function (ease-out)
                const easeOut = 1 - Math.pow(1 - progress, 3);
                
                rotation = startRotation + (targetRotation - startRotation) * easeOut;
                drawWheel();
                
                if (progress < 1) {
                    animationId = requestAnimationFrame(animate);
                } else {
                    // Animation complete
                    finishSpin(targetRotation);
                }
            }
            
            animationId = requestAnimationFrame(animate);
        }

        function finishSpin(targetRotation) {
            isSpinning = false;
            spinButton.textContent = 'Spin!';
            spinButton.disabled = false;
            
            // Calculate result
            const finalAngle = targetRotation % 360;
            const segmentAngle = 360 / enabledSnacks.length;
            const snackIndex = Math.floor(finalAngle / segmentAngle);
            const selectedIndex = enabledSnacks[snackIndex % enabledSnacks.length];
            
            selectedSnack = CONFIG.snacks[selectedIndex];
            
            // Show result
            resultText.textContent = selectedSnack;
            resultDiv.style.display = 'block';
            
            // Trigger confetti (if available)
            if (typeof confetti !== 'undefined') {
                confetti({
                    particleCount: 50,
                    spread: 70,
                    origin: { y: 0.6 },
                    colors: ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3']
                });
            }
        }

        function drawWheel() {
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 10;
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw wheel segments
            const segmentAngle = (2 * Math.PI) / enabledSnacks.length;
            
            enabledSnacks.forEach((snackIndex, index) => {
                const startAngle = index * segmentAngle;
                const endAngle = (index + 1) * segmentAngle;
                
                // Draw segment
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.closePath();
                ctx.fillStyle = CONFIG.colors[index % CONFIG.colors.length];
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // Draw text (only if size is large enough)
                if (CONFIG.size >= 200) {
                    const textAngle = startAngle + segmentAngle / 2;
                    const textX = centerX + Math.cos(textAngle) * (radius * 0.6);
                    const textY = centerY + Math.sin(textAngle) * (radius * 0.6);
                    
                    ctx.save();
                    ctx.translate(textX, textY);
                    ctx.rotate(textAngle);
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillStyle = '#fff';
                    ctx.font = `bold ${Math.max(8, CONFIG.size / 40)}px Arial`;
                    
                    // Truncate text if too long
                    const text = CONFIG.snacks[snackIndex];
                    const maxLength = CONFIG.size < 150 ? 8 : 15;
                    const displayText = text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
                    ctx.fillText(displayText, 0, 0);
                    
                    ctx.restore();
                }
            });
            
            // Draw center circle
            ctx.beginPath();
            ctx.arc(centerX, centerY, Math.max(10, CONFIG.size / 20), 0, 2 * Math.PI);
            ctx.fillStyle = '#fff';
            ctx.fill();
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        function setShowMenu(show) {
            showMenu = show;
            menuOverlay.style.display = show ? 'flex' : 'none';
        }

        // URL parameters for customization
        function parseUrlParams() {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Size parameter
            const size = urlParams.get('size');
            if (size && !isNaN(size)) {
                CONFIG.size = Math.max(150, Math.min(500, parseInt(size)));
            }
            
            // ShowControls parameter
            const showControls = urlParams.get('showControls');
            if (showControls && ['hidden', 'compact', 'full'].includes(showControls)) {
                CONFIG.showControls = showControls;
            }
            
            // Title parameter
            const title = urlParams.get('title');
            if (title !== null) {
                CONFIG.title = title;
            }
            
            // Snacks parameter (comma-separated)
            const snacks = urlParams.get('snacks');
            if (snacks) {
                CONFIG.snacks = snacks.split(',').map(s => s.trim()).filter(s => s);
                enabledSnacks = CONFIG.snacks.map((_, index) => index);
            }
        }

        // Initialize when page loads
        parseUrlParams();
        init();
    </script>
</body>
</html>
